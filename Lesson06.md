
# Lesson 6

## Title 01 - Introduction  1
Sebastian, why are Bayes Nets important? &gt;&gt; They're one of the most amazing accomplishments of recent artificial intelligence. They take the idea of uncertainty and probability and marry it with efficient structures. So you don't have a big mumble jumble but you can really understand, like what uncertain variable influences other uncertain variable. A theory of the world using just Bayes Networks is really an amazing. &gt;&gt; Well, I've been teaching AI for many years, I've found that listening to Sebastian's lessons has really given me a better intuition for Bayes Nets. As you go through these lessons, make sure to understand how to construct a Bayes Nets and how to do inference with them. One of my favorite algorithms is Monte Carlo Markov Chain. Have fun with the lesson.

## Title 02 - Exercise_ Bayes Network 
So, if you want to draw Bayes rule graphically, we have a situation where we have an internal variable A, like whether I'm going to die of cancer, but we can't sense A. Instead, we have a second variable, called B, which is our test, and B is observable, but A isn't. This is a classical example of a Bayes network. The Bayes network is composed of 2 variables, A and B. We know the prior probability for A, and we know the conditional. A causes B--whether or not we have cancer, causes the test result to be positive or not, although there was some randomness involved. So, we know what the probability of B given the different values for A, and what we care about in this specific instance is called diagnostic reasoning, which is the inverse of the causal reasoning, the probability of A given B or similarly, probability of A given not B. This is our very first Bayes network, and the graphical representation of drawing 2 variables, A and B, connected with an arc that goes from A to B is the graphical representation of a distribution of 2 variables that are specified in the structure over here, which has a prior probability and has a conditional probability as shown over here. Now, I do have a quick quiz for you. How many parameters does it take to specify the entire joint probability within A and B, or differently, the entire Bayes network? I'm not looking for structural parameters that relate to the graph over here. I'm just looking for the numerical parameters of the underlying probabilities.

## Title 03 - Exercise_ Bayes Network Solution 
And the answer is 3. It takes 1 parameter to specify P of A from which we can derive P of not A. It takes 2 parameters to specify P of B given A and P given not A, from which we can derive P not B given A and P of not B given not A. So, it's a total of 3 parameters for this Bayes network.

## Title 04 - Computing Bayes Rule 
So, we just encountered our very first Bayes network and did a number of interesting calculations. Let's now talk about Bayes Rule and look into more complex Bayes networks. I will look at Bayes Rule again and make an observation that is really non-trivial. Here is Bayes Rule, and in practice, what we find is this term here is relatively easy to compute. It's just a product, whereas this term is really hard to compute. However, this term over here does not depend on what we assume for variable A. It's just the function of B. So, suppose for a moment we also care about the complementary event of not A given B, for which Bayes Rule unfolds as follows. Then we find that the normalizer, P(B), is identical, whether we assume A on the left side or not A on the left side. We also know from prior work that P(A) given B plus P of not A given B must be one because these are 2 complementary events. That allows us to compute Bayes Rule very differently by basically ignoring the normalizer, so here's how it goes. We compute P(A) given B--and I want to call this prime, because it's not a real probability--to be just P(B) given A times P(A), which is the normalizer, so the denominator of the expression over here. We do the same thing with not A. So, in both cases, we compute the posterior probability non-normalized by omitting the normalizer B. And then we can recover the original probabilities by normalizing based on those values over here, so the probability of A given B, the actual probability, is a normalizer, eta, times this non-normalized form over here. The same is true for the negation of A over here. And eta is just the normalizer that results by adding these 2 values over here together as shown over here, and dividing them for one. So, take a look at this for a moment. What we've done is we deferred the calculation of the normalizer over here by computing pseudo probabilities that are non-normalized. This made the calculation much easier, and when we were done with everything, we just folded it back into the normalizer based on the resulting pseudo probabilities and got the correct answer.

## Title 05 - Two Test Cancer 
The reason why I gave you all this is because I want you to apply it now to a slightly more complicated problem, which is the 2-test cancer example. In this example, we again might have our unobservable cancer C, but now we're running 2 tests, test 1 and test 2. As before, the prior probability of cancer is 0.01. The probability of receiving a positive test result for either test is 0.9. The probability of getting a negative result given they're cancer free is 0.8. And from those, we were able to compute all the other probabilities, and we're just going to write them down over here. So, take a moment to just verify those. Now, let's assume both of my tests come back positive, so T1 = + and T2 = +. What's the probability of cancer now written in short form probability of C given ++? I want you to tell me what that is, and this is a non-trivial question.

## Title 06 - Two Test Cancer Solution 
So, the correct answer is 0.1698 approximately, and to compute this, I used the trick I've shown you before. Let me write down the running count for cancer and for not cancer as I integrate the various multiplications in Bayes Rule. My prior for cancer was 0.01 and for non-cancer was 0.99. Then I get my first +, and the probability of a + given they have cancer is 0.9, and the same for non-cancer is 0.2. So, according to the non-normalized Bayes Rule, I now multiply these 2 things together to get my non-normalized probability of having cancer given the plus. Since multiplication is commutative, I can do the same thing again with my 2nd test result, 0.9 and 0.2, and I multiply all of these 3 things together to get my non-normalized probability P prime to be the following: 0.0081, if you multiply those things together, and 0.0396 if you multiply these facts together. And these are not a probability. If we add those for the 2 complementary of cancer/non-cancer, I get 0.0477. However, if I now divide, that is, I normalize those non-normalized probabilities over here by this factor over here, I actually get the correct posterior probability P of cancer given ++. And they look as follows: approximately 0.1698 and approximately 0.8301.

## Title 07 - Two Test Cancer 2 
Calculate for me the probability of cancer given that I received one positive and one negative test result. Please write your number into this box.

## Title 08 - Two Test Cancer 2 Solution 
We apply the same trick as before where we use the exact same prior of 0.01. Our first + gives us the following factors: 0.9 and 0.2. And our minus gives us the probability 0.1 for a negative first test result given that we have cancer, and a 0.8 for the inverse of a negative result of not having cancer. We multiply those together. We get our non-normalized probability. And if we now normalize by the sum of those two things to turn this back into a probability, we get 0.009 over the sum of those two things over here, and this is 0.0056 for the chance of having cancer and 0.9943 for the chance of being cancer free. And this adds up approximately to 1, and therefore, is a probability distribution.

## Title 09 - Conditional Independence 
I want to use a few words of terminology. This, again, is a Bayes network, of which the hidden variable C causes the still stochastic test outcomes T1 and T2. And what is really important is that we assume not just that T1 and T2 are identically distributed. We use the same 0.9 for test 1 as we use for test 2, but we also assume that they are conditionally independent. We assumed that if God told us whether we actually had cancer or not, if we knew with absolute certainty the value of the variable C, that knowing anything about T1 would not help us make a statement about T2. Put differently, we assumed that the probability of T2 given C and T1 is the same as the probability of T2 given C. This is called conditional independence, which is given the value of the cancer variable C. If you knew this for a fact, then T2 would be independent of T1. It's conditionally independent because the independence only holds true if we actually know C, and it comes out of this diagram over here. If we look at this diagram, if you knew the variable C over here, then C separately causes T1 and T2. So, as a result, if you know C, whatever counted over here is kind of cut off causally from what happens over here. That causes these 2 variables to be conditionally independent. So, conditional independence is a really big thing in Bayes networks. Here's a Bayes network where A causes B and C, and for a Bayes network of this structure, we know that given A, B and C are independent. It's written as B conditionally independent of C given A. So, here's a question. Suppose we have conditional independence between B and C given A. Would that imply--and there's my question--that B and C are independent? So, suppose we don't know A. We don't know whether we have cancer, for example. What that means is that the test results individually are still independent of each other even if we don't know about the cancer situation. Please answer yes or no.

## Title 10 - Conditional Independence Solution 
And the correct answer is No Intuitively, getting a positive test result about cancer gives us information about whether you have cancer or not. So if you get a positive test result you're going to raise the probability of having cancer relative to the prior probability. With that increased probability we will predict that another test will with a higher likelihood give us a positive response than if we hadn't taken the previous test. That's really important to understand So that we understand it let me make you calculate those probabilities

## Title 11 - Conditional Independence 2 
Let me draw the cancer example again with two tests. Here's my cancer variable and then there's two conditionally independent tests T1 and T2. And as before let me assume that the prior probability of cancer is 0.01 What I want you to compute for me is the probability of the second test to be positive if we know that the first test was positive. So write this into the following box.

## Title 12 - Conditional Independence 2 Solution 
So, for this one, we want to apply total probability. This thing over here is the same as probability of test 2 to be positive, which I'm going to abbreviate with a +2 over here, conditioned on test 1 being positive and me having cancer times the probability of me having cancer given test 1 was positive plus the probability of test 2 being positive conditioned on test 1 being positive and me not having cancer times the probability of me not having cancer given that test 1 is positive. That's the same as the theorem of total probability, but now everything is conditioned on +1. Take a moment to verify this. Now, here I can plug in the numbers. You already calculated this one before, which is approximately 0.043, and this one over here is 1 minus that, which is 0.957 approximately. And this term over here now exploits conditional independence, which is given that I know C, knowledge of the first test gives me no more information about the second test. It only gives me information if C was unknown, as was the case over here. So, I can rewrite this thing over here as follows: P of +2 given that I have cancer. I can drop the +1, and the same is true over here. This is exploiting my conditional independence. I knew that P of +1 or +2 conditioned on C is the same as P of +2 conditioned on C and +1. I can now read those off my table over here, which is 0.9 times 0.043 plus 0.2, which is 1 minus 0.8 over here times 0.957, which gives me approximately 0.2301. So, that says if my first test comes in positive, I expect my second test to be positive with probably 0.2301. That's an increased probability to the default probability, which we calculated before, which is the probability of any test, test 2 come in as positive before was the normalizer of Bayes rule which was 0.207. So, my first test has a 20% chance of coming in positive. My second test, after seeing a positive test, has now an increased probability of about 23% of coming in positive.

## Title 13 - Absolute And Conditional 
So, now we've learned about independence, and the corresponding Bayes network has 2 nodes. They're just not connected at all. And we learned about conditional independence, in which case we have a Bayes network that looks like this. Now I would like to know whether absolute independence implies conditional independence. True or false? And I'd also like to know whether conditional independence implies absolute independence. Again, true or false?

## Title 14 - Absolute And Conditional Solution 
And the answer is both of them are false. We already saw that conditional independence, as shown over here, doesn't give us absolute independence. So, for example, this is test #1 and test #2. You might or might not have cancer. Our first test gives us information about whether you have cancer or not. As a result, we've changed our prior probability for the second test to come in positive. That means that conditional independence does not imply absolute independence, which means this assumption here falls, and it also turns out that if you have absolute independence, things might not be conditionally independent for reasons that I can't quite explain so far, but that we will learn about next.

## Title 15 - Confounding Cause 
[Thrun] For my next example, I will study a different type of a Bayes network. Before, we've seen networks of the following type, where a single hidden cause caused 2 different measurements. I now want to study a network that looks just like the opposite. We have 2 independent hidden causes, but they get confounded within a single observational variable. I would like to use the example of happiness. Suppose I can be happy or unhappy. What makes me happy is when the weather is sunny or if I get a raise in my job, which means I make more money. So let's call this sunny, let's call this a raise, and call this happiness. Perhaps the probability of it being sunny is 0.7, probability of a raise is 0.01. And I will tell you that the probability of being happy is governed as follows. The probability of being happy given that both of these things occur-- I got a raise and it is sunny--is 1. The probability of being happy given that it is not sunny and I still got a raise is 0.9. The probability of being happy given that it's sunny but I didn't get a raise is 0.7. And the probability of being happy given that it is neither sunny nor did I get a raise is 0.1. This is a perfectly fine specification of a probability distribution where 2 causes affect the variable down here, the happiness. So I'd like you to calculate for me the following questions. Probability of a raise given that it is sunny, according to this model. Please enter your answer over here.

## Title 16 - Independence 
[Thrun] The answer is surprisingly simple. It is 0.01. How do I know this so fast? Well, if you look at this Bayes network, both the sunniness and the question whether I got a raise impact my happiness. But since I don't know anything about the happiness, there is no way that just the weather might implicate or impact whether I get a raise or not. In fact, it might be independently sunny, and I might independently get a raise at work. There is no mechanism of which these 2 things would co-occur. Therefore, the probability of a raise given that it's sunny is just the same as the probability of a raise given any weather, which is 0.01.

## Title 17 - Explaining Away 
[Thrun] Let me talk about a really interesting special instance of Bayes net reasoning which is called explaining away. And I'll first give you the intuitive answer, then I'll wish you to compute probabilities for me that manifest the explain away effect in a Bayes network of this type. Explaining away means that if we know that we are happy, then sunny weather can explain away the cause of happiness. If I then also know that it's sunny, it becomes less likely that I received a raise. Let me put this differently. Suppose I'm a happy guy on a specific day and my wife asks me, "Sebastian, why are you so happy?" Is it sunny, or did you get a raise? If she then looks outside and sees it is sunny, then she might explain to herself, Well, Sebastian is happy because it is sunny. "That makes it effectively less likely that he got a raise  17 00:01:05,000 --> 00:01:10,000 because I could already explain his happiness by it being sunny.""" If she looks outside and it is rainy, that makes it more likely I got a raise, because the weather can't really explain my happiness. In other words, if we see a certain effect that could be caused by multiple causes, seeing one of those causes can explain away any other potential cause of this effect over here. So let me put this in numbers and ask you the challenging question of what's the probability of a raise given that I'm happy and it's sunny?

## Title 18 - Explaining Away Solution 
[Thrun] The answer is approximately 0.0142, and it is an exercise in expanding this term using Bayes' rule, using total probability, which I'll just do for you. Using Bayes' rule, you can transform this into P of H given R comma S times P of R given S over P of H given S. We observe the conditional independence of R and S to simplify this to just P of R, and the denominator is expanded by folding in R and not R, P of H given R comma S times P of R plus P of H given not R and S times P of not R, which is total probability. We can now read off the numbers from the tables over here, which gives us 1 times 0.01 divided by this expression that is the same as the expression over here, so 0.01 plus this thing over here, which you can find over here to be 0.7, times this guy over here, which is 1 minus the value over here, 0.99, which gives us approximately 0.0142.

## Title 19 - Explaining Away 2 
[Thrun] Now, to understand the explain away effect, you have to compare this to the probability of a raise given that we're just happy and we don't know anything about the weather. So let's do that exercise next. So my next quiz is, what's the probability of a raise given that all I know is that I'm happy and I don't know about the weather? This happens to be once again a pretty complicated question, so take your time.

## Title 20 - Explaining Away 2 Solution 
[Thrun] So this is a difficult question. Let me compute an auxiliary variable, which is P of happiness. That one is expanded by looking at the different conditions that can make us happy. P of happiness given S and R times P of S and R, which is of course the product of those 2 because they are independent, plus P of happiness given not S R, probability of not as R plus P of H given S and not R times the probability of P of S and not R plus the last case, P of H given not S and not R. So this just looks at the happiness under all 4 combinations of the variables that can lead to happiness. And you can plug those straight in. This one over here is 1, and this one over here is the product of S and R, which is 0.7 times 0.01. And as you plug all of those in, you get as a result 0.5245. That's P of H. Just take some time and do the math by going through these different cases using total probability, and you get this result. Armed with this number, the rest now becomes easy, which is we can use Bayes' rule to turn this around. P of H given R times P of R over P of H. P of R we know from over here, the probability of a raise is 0.01. So the only thing we need to compute now is P of H given R. And again, we apply total probability. Let me just do this over here. We can factor P of H given R as P of H given R and S, sunny, times probability of sunny plus P of H given R and not sunny times the probability of not sunny. And if you plug in the numbers with this, you get 1 times 0.7 plus 0.9 times 0.3. That happens to be 0.97. So if we now plug this all back into this equation over here, we get 0.97 times 0.01 over 0.5245. This gives us approximately as the correct answer 0.0185.

## Title 21 - Explaining Away 3  
And if you got this right, I will be deeply impressed by the fact that you got this right. My happiness is well explained by the fact it's sunny. So if someone observes me to be happy and asks the question, Is this because Sebastian got a raise at work? Well, if you know it's sunny and this is a fairly good explanation for me being happy, you don't have to assume I got a raise. If you don't know about the weather, then obviously the chances are higher that the raise caused my happiness, and therefore this never goes up from .014 to .018. Now, let me ask you one final question in this next quiz, which is the probability of a raise, given that I look happy, and it's not sunny. This is the most extreme case for making a raise likely, because I am a happy guy, and it's definitely not caused by the weather. So it could just be random, or it could be caused by the raise. So please calculate this number for me and enter it into this box.

## Title 22 - Explaining Away 3 Solution 
[Thrun] Well, the answer follows the exact same scheme as before, with S being replaced by not S. So this should be an easier question for you to answer. P of R given H and not S can be inverted by Bayes' rule to be as follows. Once we apply Bayes' rule, as indicated over here where we swapped H to the left side and R to the right side, you can observe that this value over here can be readily found in the table. It's actually the 0.9 over there. This value over here, the raise is independent of the weather by virtue of our Bayes network, so it's just 0.01. And as before, we apply total probability to the expression over here, and we obtain off this quotient over here that these 2 expressions are the same. P of H given not S, not R is the value over here, and the 0.99 is the complement of probability of R taken from over here, and that ends up to be 0.0833. This would have been the right answer.

## Title 23 - Conditional Dependence 
[Thrun] It's really interesting to compare this to the situation over here. In both cases I'm happy, as shown over here, and I ask the same question, which is whether I got a raise at work, as R over here. But in one case I observe that the weather is sunny; in the other one it isn't. And look what it does to my probability of having received a raise. The sunniness perfectly well explains my happiness, and my probability of having received a raise ends up to be a mere 1.4%, or 0.014. However, if my wife observes it to be non-sunny, then it is much more likely that the cause of my happiness is related to a raise at work, and now the probability is 8.3%, which is significantly higher than the 1.4% before. This is a Bayes network of which S and R are independent but H adds a dependence between S and R. Let me talk about this in a little bit more detail on the next paper. So here is our Bayes network again. In our previous exercises, we computed for this network that the probability of a raise of R given any of these variables shown here was as follows. The really interesting thing is that in the absence of information about H, which is the middle case over here, the probability of R is unaffected by knowledge of S-- that is, R and S are independent. This is the same as probability of R, and R and S are independent. However, if I know something about the variable H, then S and R become dependent-- that is, knowing about my happiness over here renders S and R dependent. This is not the same as probability of just R given H. Obviously, it isn't because if I now vary S from S to not S, it affects my probability for the variable R. That is a really unusual situation where we have R and S are independent but given the variable H, R and S are not independent anymore. So knowledge of H makes 2 variables that previously were independent non-independent. Offered differently, 2 variables that are independent may not be in certain cases conditionally independent. Independence does not imply conditional independence.

## Title 24 - General Bayes Net 
[Thrun] So we're now ready to define Bayes networks in a more general way. Bayes networks define probability distributions over graphs or random variables. Here is an example graph of 5 variables, and this Bayes network defines the distribution over those 5 random variables. Instead of enumerating all possibilities of combinations of these 5 random variables, the Bayes network is defined by probability distributions that are inherent to each individual node. For node A and B, we just have a distribution P of A and P of B because A and B have no incoming arcs. C is a conditional distribution conditioned on A and B. D and E are conditioned on C. The joint probability represented by a Bayes network is the product of various Bayes network probabilities that are defined over individual nodes where each node's probability is only conditioned on the incoming arcs. So A has no incoming arc; therefore, we just want it P of A. C has 2 incoming arcs, so we define the probability of C conditioned on A and B. And D and E have 1 incoming arc that's shown over here. The definition of this joint distribution by using the following factors has one really big advantage. Whereas the joint distribution over any 5 variables requires 2 to the 5 minus 1, which is 31 probability values, the Bayes network over here only requires 10 such values. P of A is one value, for which we can derive P of not A. Same for P of B. P of C given A B is derived by a distribution over C conditioned on any combination of A and B, of which there are 4 of A and B as binary. P of D given C is 2 parameters for P of D given C and P of D given not C. And the same is true for P of E given C. So if you add those up, you get 10 parameters in total. So the compactness of the Bayes network leads to a representation that scales significantly better to large networks than the common natorial approach which goes through all combinations of variable values. That is a key advantage of Bayes networks, and that is the reason why Bayes networks are being used so extensively for all kinds of problems. So here is a quiz. How many probability values are required to specify this Bayes network? Please put your answer in the following box.

## Title 25 - General Bayes Net Solution 
[Thrun] And the answer is 13. One over here, 2 over here, and 4 over here. Simplifiably speaking, any variable that has K inputs requires 2 to the K such variables. So in total we have 1, 9, 13.

## Title 26 - General Bayes Net 2 
[Thrun] Here's another quiz. How many parameters do we need to specify the joint distribution for this Bayes network over here where A, B, and C point into D, D points into E, F, and G and C also points into G? Please write your answer into this box.

## Title 27 - General Bayes Net 2 Solution 
[Thrun] And the answer is 19. So 1 here, 1 here, 1 here, 2 here, 2 here, 2 arcs point into G, which makes for 4, and 3 arcs point into D. Two to the 3 is 8. So we get 1, 2, 3, 8, 2, 2, 4. If you add those up, it's 19.

## Title 28 - General Bayes Net 3
And here is our current rope, which we discussed at the very beginning of this unit. How many parameters do we need to specify this net worth? Remember there are 16 total variables and the naive joint over the 16 will be 2 to 16th minus 1, which is 65,535. Please write your answer into this box over here.

## Title 29 - General Bayes Net 3 Solution 
[Thrun] To answer this question, let us add up these numbers. Battery age is 1, 1, 1. This has 1 incoming arc, so it's 2. Two incoming arcs makes 4. One incoming arc is 2, 2 equals 4. Four incoming arcs makes 16. If we add all the right numbers, we get 47.

## Title 30 - Value Of A Network 
[Thrun] So it takes 47 numerical probabilities to specify the joint compared to 65,000 if you didn't have the graph-like structure. I think this example really illustrates the advantage of compact Bayes network representations over unstructured joint representations.

## Title 31 - D Separation 
[Thrun] The next concept I'd like to teach you is called D-separation. And let me start the discussion of this concept by a quiz. We have here a Bayes network, and I'm going to ask you a conditional independence question. Is C independent of A? Please tell me yes or no. Is C independent of A given B? Is C independent of D? Is C independent of D given A? And is E independent of C given D?

## Title 32 - D Separation Solution 
[Thrun] So C is not independent of A. In fact, A influences C by virtue of B. But if you know B, then A becomes independent of C, which means the only determinate into C is B. If you know B for sure, then knowledge of A won't really tell you anything about C. C is also not independent of D, just the same way C is not independent of A. If I learn something about D, I can infer more about C. But if I do know A, then it's hard to imagine how knowledge of D would help me with C because I can't learn anything more about A than knowing A already. Therefore, given A, C and D are independent. The same is true for E and C. If we know D, then E and C become independent.

## Title 33 - D Separation 2 
[Thrun] In this specific example, the rule that we could apply is very, very simple. Any 2 variables are independent if they're not linked by just unknown variables. So for example, if we know B, then everything downstream of B becomes independent of anything upstream of B. E is now independent of C, conditioned on B. However, knowledge of B does not render A and E independent. In this graph over here, A and B connect to C and C connects to D and to E. So let me ask you, is A independent of E, A independent of E given B, A independent of E given C, A independent of B, and A independent of B given C?

## Title 34 - D Separation 2 Solution 
[Thrun] And the answer for this one is really interesting. A is clearly not independent of E because through C we can see an influence of A to E. Given B, that doesn't change. A still influences C, despite the fact we know B. However, if we know C, the influence is cut off. There is no way A can influence E if we know C. A is clearly independent of B. They are different entry variables. They have no incoming arcs. But here is the caveat. Given C, A and B become dependent. So whereas initially A and B were independent, if you give C, they become dependent. And the reason why they become dependent we've studied before. This is the explain away effect. If you know, for example, C to be true, then knowledge of A will substantially affect what we believe about B. If there's 2 joint causes for C and we happen to know A is true, we will discredit cause B. If we happen to know A is false, we will increase our belief for the cause B. That was an effect we studied extensively in the happiness example I gave you before. The interesting thing here is we are facing a situation where knowledge of variable C renders previously independent variables dependent.

## Title 35 - D Separation 3
This leads me to the general study of position independence in base networks. Often called D-separation, or reachability. D-separation is best studied by so-called active triplets and inactive triplets. Active triplets render variables dependent. And inactive triplets render them independent. Any chain of three variables like this makes the initial and final variable dependent if all variables are known. However, if the center variable is known. That is, it's behind the conditioning bar. Then this variable and this variable become independent. So if you have a structure like this. And it's, quote unquote, cut off by a known variable in the middle. That separates or de-separates the left variable from the right variable, and they become independent. Similarly, any structure like this renders the left variable and the right variable dependent on this. The center variable is no. In which case, the left and right variable become independent. Another active triplet now requires knowledge of a variable. This is the explain away case. If this variable is known for a base network that converges into a single variable. Then this variable and this variable over here become dependent. Contrast this to the case where all variables are unknown. A situation like this means that this variable on the left or on the right are actually independent. In a single final example. We also get dependents if we have the following situation. A direct successor of a conversion variable is known. So it is sufficient if a successor of this variable is known. The variable, itself, does not have to be known. And the reason is, if you know this guy over here. We need to get knowledge about this guy over here. And by virtue of it, the case over here essentially applies. If you look at those rules. Those rules allow you to determine, for any base network, where the variables are dependent or not dependent. Given the evidence you have. If you color the notes dark, for which you do have evidence. Then you can use these rules to understand whether any two variables are conditionally dependent or not. So let me ask you for this relatively complicated base network, the following questions. Is F independent of A? Is F independent of A, given D? Is F independent of A given G? And is F independent of A, given H? Please mark your answers as you see fit.

## Title 36 - D Separation 3 Solution 
[Thrun] And the answer is yes, F is independent of A. What we find for our rules of D-separation is that F is dependent on D and A is dependent on D. But if you don't know D, you can't govern any dependence between A and F at all. If you do know D, then F and A become dependent. And the reason is B and E are dependent given D, and we can transform this back into dependence of A and F because B and A are dependent and E and F are dependent. There is an active path between A and F which goes across here and here because D is known. If we know G, the same thing is true because G gives us knowledge about D, and D can be applied back to this path over here. However, if you know H, that's not the case. So H might tell us something about G, but it doesn't tell us anything about D, and therefore, we have no reason to close the path between A and F. The path between A and F is still passive, even though we have knowledge of H.

## Title 37 - Congratulations! 
[Thrun] So congratulations. You learned a lot about Bayes networks. You learned about the graph structure of Bayes networks, you understood how this is a compact representation, you learned about conditional independence, and we talked a little bit about application of Bayes network to interesting reasoning problems. But by all means this was a mostly theoretical unit of this class, and in future classes we will talk more about applications. The instrument of Bayes networks is really essential to a number of problems. It really characterizes the sparse dependence that exists in many readable problems like in robotics and computer vision and filtering and diagnostics and so on. I really hope you enjoyed this class, and I really hope you understood in depth how Bayes networks work.

## Title 38 - Overview And Example 
[Probabilistic Interference] [Male] Welcome back. In the previous unit, we went over the basics of probability theory and saw how a Bayes network could concisely represent a joint probability distribution, including the representation of independence between the variables. In this unit, we will see how to do probabilistic inference. That is, how to answer probability questions using Bayes nets. Let's put up a simple Bayes net. We'll use the familiar example of the earthquake where we can have a burglary or an earthquake setting off an alarm, and if the alarm goes off, either John or Mary might call. Now, what kinds of questions can we ask to do inference about? The simplest type of question is the same question we ask with an ordinary subroutine or function in a programming language. Namely, given some inputs, what are the outputs? So, in this case, we could say given the inputs of B and E, what are the outputs, J and M? Rather than call them input and output variables, in probabilistic inference, we'll call them evidence and query variables. That is, the variables that we know the values of are the evidence, and the ones that we want to find out the values of are the query variables. Anything that is neither evidence nor query is known as a hidden variable. That is, we won't tell you what its value is. We won't figure out what its value is and report it, but we'll have to compute with it internally. And now furthermore, in probabilistic inference, the output is not a single number for each of the query variables, but rather, it's a probability distribution. So, the answer is going to be a complete, joint probability distribution over the query variables. We call this the posterior distribution, given the evidence, and we can write it like this. It's the probability distribution of one or more query variables given the values of the evidence variables. And there can be zero or more evidence variables, and each of them are given an exact value. And that's the computation we want to come up with. There's another question we can ask. Which is the most likely explanation? That is, out of all the possible values for all the query variables, which combination of values has the highest probability? We write the formula like this, asking which Q values are maxable given the evidence values. Now, in an ordinary programming language, each function goes only one way. It has input variables, does some computation, and comes up with a result variable or result variables. One great thing about Bayes nets is that we're not restricted to going only in one direction. We could go in the causal direction, giving as evidence the route nodes of the tree and asking as query values the nodes at the bottom. Or, we could reverse that causal flow. For example, we could have J and M be the evidence variables and B and E be the query variables, or we could have any other combination. For example, we could have M be the evidence variable and J and B be the query variables. Here's a question for you. Imagine the situation where Mary has called to report that the alarm is going off, and we want to know whether or not there has been a burglary. For each of the nodes, click on the circle to tell us if the node is an evidence node, a hidden node, or a query node.

## Title 39 - Overview And Example Solution 
The answer is that Mary calling is the evidence node. The burglary is the query node, and all the others are hidden variables in this case.

## Title 40 - Enumeration  
Now we're going to talk about how to do inference on Bays Net. We'll start with our familiar network, and we'll talk about a method called enumeration, which goes through all the possibilities, adds them up, and comes up with an answer. So what we do is start by stating the problem. We're going to ask the question of, "What is the probability that the burglar alarm occurred, given that John called and Mary called?" We'll use the definition of conditional probability to answer this. So this query is equal to the joint probability distribution of all three variables, divided by the conditionalized variables. Now, note I'm using a notation here where, instead of writing out the probability of some variable equals true, I'm just using the notation, "Plus," and then the variable name in lowercase. And if I wanted the negation, I would use negation sign. Notice there's a different notation where, instead of writing out the plus and negation signs, we just use the variable name itself, P of E, to indicate E is true. That notation works well, but it can get confusing between, "Does P of E mean E is true, or does it mean E is a variable? And so we're going to stick to the notation where we explicitly have the pluses and negation signs. To do inference by enumeration, we first take a conditional probability and rewrite it as unconditional probabilities. Now we enumerate all the atomic probabilities and calculate the sum of products. Let's look at just the complex term on the numerator first. The procedure for figuring out the denominator would be similar, and we'll skip that. So, the probability of these three terms together can be determined by enumerating all possible values of the hidden variables. In this case there are two--E and A. So we'll sum over those variables for all values of E, and for all values of A-- In this case they're Boolean, so there's only two values of each. We ask, "What's the probability of this unconditional term?" And that we get by summing out over all possibilities, E and A being true or false. Now, to get the values of these atomic events, we'll have to rewrite this equation in a form that corresponds to the conditional probability tables that we have associated with the Bays net. So we'll take this whole expression and rewrite it. It's still a sum over the hidden variables, E and A. But now I'll rewrite this expression in terms of the parents of each of the nodes in the network. So that gives us the product of these five terms, which we then have to sum over all values of E and A. If we call this product F of EA, then the whole answer is the sum of f for all values of E and A. So it's the sum of four terms, where each of the terms is a product of five numbers. Where do we get the numbers to fill in this equation? From the conditional probability tables from our model. So let's put the equation back up, and we'll ask you for the case where both E and A are positive, two look up in the conditional probability tables, and fill in the numbers for each of these five terms, and then multiply them together and fill in the product.

## Title 41 - Enumeration Solution 
We get the answer by reading numbers off the conditional probability tables, so probability of B being positive is 0.001. Of E being positive, because we're dealing with the positive case now for the variable E, is 0.002. The probability of A being positive, because we're dealing with that case, given that B is positive and the case for an E is positive, that we can read off here as 0.95. The probability that J is positive given that A is positive is 0.9. And finally, the probability that M is positive given that A is positive we read off here as 0.7. We multiple all those together, it's going to be a small number because we've got the .001 and the .002 here. Can't quite fit it in the box, but it works out to .000001197. That seems like a really small number, but remember, we have to normalize by the P(+j,+m) term, and this is only 1 of the 4 possibilities. We have to enumerate over all 4 possibilities for E and A, and in the end, it works out that the probability of the burglar alarm being true given that John and Mary calls, is 0.284. And we get that number because intuitively, it seems that the alarm is fairly reliable. John and Mary calling are very reliable, but the prior probability of burglary is low. And those 2 terms combine together to give us the 0.284 value when we sum up each of the 4 terms of these products.

## Title 42 - Speeding Up Enumeration 
[Norvig] We've seen how to do enumeration to solve the inference problem on belief networks. For a simple network like the alarm network, that's all we need to know. There's only 5 variables, so even if all 5 of them were hidden, there would only be 32 rows in the table to sum up. From a theoretical point of view, we're done. But from a practical point of view, other networks could give us trouble. Consider this network, which is one for determining insurance for car owners. There are 27 different variables. If each of the variables were boolean, that would give us over 100 million rows to sum out. But in fact, some of the variables are non-boolean, they have multiple values, and it turns out that representing this entire network and doing enumeration we'd have to sum over a quadrillion rows. That's just not practical, so we're going to have to come up with methods that are faster than enumerating everything. The first technique we can use to get a speed-up in doing inference on Bayes nets is to pull out terms from the enumeration. For example, here the probability of b is going to be the same for all values of E and a. So we can take that term and move it out of the summation, and now we have a little bit less work to do. We can multiply by that term once rather than having it in each row of the table. We can also move this term, the P of e, to the left of the summation over a, because it doesn't depend on a. By doing this, we're doing less work. The inner loop of the summation now has only 3 terms rather than 5 terms. So we've reduced the cost of doing each row of the table. But we still have the same number of rows in the table, so we're going to have to do better than that. The next technique for efficient inference is to maximize independence of variables. The structure of a Bayes net determines how efficient it is to do inference on it. For example, a network that's a linear string of variables, X1 through Xn, can have inference done in time proportional to the number n, whereas a network that's a complete network where every node points to every other node and so on could take time 2 to the n if all n variables are boolean variables. In the alarm network we saw previously, we took care to make sure that we had all the independence relations represented in the structure of the network. But if we put the nodes together in a different order, we would end up with a different structure. Let's start by ordering the node John calls first and then adding in the node Mary calls. The question is, given just these 2 nodes and looking at the node for Mary calls, is that node dependent or independent of the node for John calls?

## Title 43 - Speeding Up Enumeration Solution 
[Norvig] The answer is that the node for Mary calls in this network is dependent on John calls. In the previous network, they were independent given that we knew that the alarm had occurred. But here we don't know that the alarm had occurred, and so the nodes are dependent because having information about one will affect the information about the other.

## Title 44 - Speeding Up Enumeration 2 
[Norvig] Now we'll continue and we'll add the node A for alarm to the network. And what I want you to do is click on all the other variables that A is dependent on in this network.

## Title 45 - Speeding Up Enumeration 2 Solution .srt

## Title 45 - Speeding Up Enumeration 2 Solution
And the answer is that alarm is dependent on both John and Mary. And so we can draw both nodes in, both arrows in. Intuitively that make sense. Because if John calls, then it's more likely that the alarm has occurred, likewise as if Mary calls and if both called, it's really likely. So you can figure out the answer by intuitive reasoning. Or you can figure it out by going to the conditional probability tables, and seeing, according to the definition of conditional probability, whether the numbers work out. [BLANK_AUDIO]

## Title 46 - Speeding Up Enumeration 3 
[Norvig] Now we'll continue and we'll add the node B for burglary and ask again, click on all the variables that B is dependent on.

## Title 47 - Speeding Up Enumeration 3 Solution 
[Norvig] The answer is that B is dependent only on A. In other words, B is independent of J and M given A.

## Title 48 - Speeding Up Enumeration 4 
[Norvig] And finally, we'll add the last node, E, and ask you to click on all the nodes that E is dependent on.

## Title 49 - Speeding Up Enumeration 4 Solution 
[Norvig] And the answer is that E is dependent on A. That much is fairly obvious. But it's also dependent on B. Now, why is that? E is dependent on A because if the earthquake did occur, then it's more likely that the alarm would go off. On the other hand, E is also dependent on B because if a burglary occurred, then that would explain why the alarm is going off, and it would mean that the earthquake is less likely.

## Title 50 - Causal Direction 
[Norvig] The moral is that Bayes nets tend to be the most compact and thus the easier to do inference on when they're written in the causal direction-- that is, when the networks flow from causes to effects.

## Title 51 - Variable Elimination 
Let's return to this equation, which we use to show how to do inference by enumeration. In this equation, we join up the whole joint distribution before we sum out over the hidden variables. That's slow, because we end up repeating a lot of work. Now we're going to show a new technique called variable elimination, which in many networks operates much faster. It's still a difficult computation, an NP-hard computation, to do inference over Bayes nets in general. Variable elimination works faster than inference by enumeration in most practical cases. It requires an algebra for manipulating factors, which are just names for multidimensional arrays that come out of these probabilistic terms. We'll use another example to show how variable elimination works. We'll start off with a network that has 3 boolean variables. R indicates whether or not it's raining. T indicates whether or not there's traffic, and T is dependent on whether it's raining. And finally, L indicates whether or not I'll be late for my next appointment, and that depends on whether or not there's traffic. Now we'll put up the conditional probability tables for each of these 3 variables. And then we can use inference to figure out the answer to questions like am I going to be late? And we know by definition that we could do that through enumeration by going through all the possible values for R and T and summing up the product of these 3 nodes. Now, in a simple network like this, straight enumeration would work fine, but in a more complex network, what variable elimination does is give us a way to combine together parts of the network into smaller parts and then enumerate over those smaller parts and then continue combining. So, we start with a big network. We eliminate some of the variables. We compute by marginalizing out, and then we have a smaller network to deal with, and we'll show you how those 2 steps work. The first operation in variable elimination is called joining factors. A factor, again, is one of these tables. It's a multidimensional matrix, and what we do is choose 2 of the factors, 2 or more of the factors. In this case, we'll choose these 2, and we'll combine them together to form a new factor which represents the joint probability of all the variables in that factor. In this case, R and T. Now we'll draw out that table. In each case, we just look up in the corresponding table, figure out the numbers, and multiply them together. For example, in this row we have a +r and a +t, so the +r is 0.1, and the entry for +r and +t is 0.8, so multiply them together and you get 0.08. Go all the way down. For example, in the last row we have a -r and a -t. -r is 0.9. The entry for -r and -t is also 0.9. Multiply those together and you get 0.81. So, what have we done? We used the operation of joining factors on these 2 factors, getting us a new factor which is part of the existing network. Now we want to apply a second operation called elimination, also called summing out or marginalization, to take this table and reduce it. Right now, the tables we have look like this. We could sum out or marginalize over the variable R to give us a table that just operates on T. So, the question is to fill in this table for P(T)-- there will be 2 entries in this table, the +t entry, formed by summing out all the entries here for all values of r for which t is positive, and the -t entry, formed the same way, by looking in this table and summing up all the rows over all values of r where t is negative. Put your answers in these boxes.

## Title 52 - Variable Elimination Solution 
The answer is that for +t we look up the 2 possible values for r, and we get 0.08 or 0.09. Sum those up, get 0.17, and then we look at the 2 possible values of R for -t, and we get 0.02 and 0.81. Add those up, and we get 0.83.

## Title 53 - Variable Elimination 2 
So, we took our network with RT and L. We summed out over R. That gives us a new network with T and L with these conditional probability tables. And now we want to do a join over T and L and give us a new table with the joint probability of P(T, L). And that table is going to look like this.

## Title 54 - Variable Elimination 2 Solution 
The answer, again, for joining variables is determined by pointwise multiplication, so we have 0.17 times 0.3 is 0.051, +t and +l, 0.17 times 0.7 is 0.119. Then we go to the minuses. Minus 0.83 times 0.1 is 0.083. And finally, 0.83 times 0.9 is 0.747.

## Title 55 - Variable Elimination 3 
Now we're down to a network with a single node, T, L, with this joint probability table, and the only operation we have left to do is to sum out to give us a node with just L in it. So, the question is to compute P(L) for both values of L, #NAME?

## Title 56 - Variable Elimination 3 Solution  
The answer is that the positive L values--.051 plus .083 equals .134. And the negative values, .119 plus .747 equals .866.

## Title 57 - Variable Elimination 4  
So that's how variable elimination works. It's a continued process of joining together factors to form a larger factor, and then eliminating variables by summing out. If we make a good choice of the order in which we apply these operations, then variable elimination can be much more efficient than just doing the whole enumeration.

## Title 58 - Approximate Inference  1
Now I want to talk about [BLANK_AUDIO] Approximate inference by means of sampling. What do I mean by that? Say we want to deal with a joint probability distribution. Say the distribution of heads and tails over these two coins. We can build table, and then start counting by sampling. Here we have our first sample. We flip the coins and the one cent piece came up heads. And the five cent piece came up tails. So we mark down one count [BLANK_AUDIO] Then we toss them again. This time the five cent is heads, and the one cent is tails. So we put down a count there, and we repeat that process. [BLANK_AUDIO] And keep repeating it. [BLANK_AUDIO] Until we got enough counts that we could estimate the joint probability distribution by looking at the counts. Now if we do a small number of samples, the counts might not be very accurate. There may be some random variation that causes them not to converge to the true values. But as we add more counts, as we add more samples, the counts we get will come closer to the true distribution. Thus, sampling has an advantage over inference in that we know a procedure for coming up with at least an approximate value for the joint probability distribution. As opposed to exact inference, where the computation may be very complex. There's another advantage to sampling, which is, if we don't know what the conditional probability tables are, as we did in our other models, if we don't know these numeric values, but we can simulate the process, we can still proceed with sampling, whereas we couldn't with exact inference.

## Title 59 - Sampling Example 
Here's a new network that we'll use to investigate how sampling can be used to do inference. In this network, we have 4 variables. They're all boolean. Cloudy tells us if it's cloudy or not outside, and that can have an effect on whether the sprinklers are turned on, and whether it's raining. And those 2 variables in turn have an effect on whether the grass gets wet. Now, to do inference over this network using sampling, we start off with a variable where all the parents are defined. In this case, there's only one such variable, Cloudy. And it's conditional probability table tells us that the probability is 50% for Cloudy, 50% for not Cloudy, and so we sample from that. We generate a random number, and let's say it comes up with positive for Cloudy. Now that variable is defined, we can choose another variable. In this case, let's choose Sprinkler, and we look at the rows in the table for which Cloudy, the parent, is positive, and we see we should sample with probability 10% to +s and 90% a -s. And so let's say we do that sampling with a random number generator, and it comes up negative for Sprinkler. Now let's jump over here. Look at the Rain variable. Again, the parent, Cloudy, is positive, so we're looking at this part of the table. We get a 0.8 probability for Rain being positive, and a 0.2 probability for Rain being negative. Let's say we sample that randomly, and it comes up Rain is positive. And now we're ready to sample the final variable, and what I want you to do is tell me which of the rows of this table should we be considering and tell me what's more likely. Is it more likely that we have a +w or a -w?

## Title 60 - Sampling Example Solution 
The answer to the question is that we look at the parents. We find that the Sprinkler variable is negative, so we're looking at this part of the table. And the Rain variable is positive, so we're looking at this part. So, it would be these 2 rows that we would consider, and thus, we'd find there's a 0.9 probability for w, the grass being wet, and only 0.1 for it being negative, so the positive is more likely. And once we've done that, then we generated a complete sample, and we can write down the sample here. We had +c, -s, +r. And assuming we got a probability of 0.9 came out in favor of the +w, that would be the end of the sample. Then we could throw all this information out and start over again by having another 50/50 choice for cloudy and then working our way through the network.

## Title 61 - Approximate Inference 2 
Now, the probability of sampling a particular variable, choosing a +w or a -w, depends on the values of the parents. But those are chosen according to the conditional probability tables, so in the limit, the count of each sampled variable will approach the true probability. That is, with an infinite number of samples, this procedure computes the true joint probability distribution. We say that the sampling method is consistent. We can use this kind of sampling to compute the complete joint probability distribution, or we can use it to compute a value for an individual variable. But what if we wanted to compute a conditional probability? Say we wanted to compute the probability of wet grass given that it's not cloudy. To do that, the sample that we generated here wouldn't be helpful at all because it has to do with being cloudy, not with being not cloudy. So, we would cross this sample off the list. We would say that we reject the sample, and this technique is called rejection sampling. We go through ignoring any samples that don't match the conditional probabilities that we're interested in and keeping samples that do, say the sample -c, +s, +r, -w. We would just continue going through generating samples, crossing off the ones that don't match, keeping the ones that do. And this procedure would also be consistent. We call this procedure rejection sampling.

## Title 62 - Rejection Sampling 
But there's a problem with rejection sampling. If the evidence is unlikely, you end up rejecting a lot of the samples. Let's go back to the alarm network where we had variables for burglary and for an alarm and say when arrested, in computing the probability of a burglary, given that the alarm goes off. The problem is that burglaries are very infrequent, so most of the samples we would get would end up being-- we start with generating a B, and we get a -b and then a -a. We go back and say does this match? No, we have to reject this sample, so we generate another sample, and we get another -b, -a. We reject that. We get another -b, -a. And we keep rejecting, and eventually we get a +b, but we'd end up spending a lot of time rejecting samples. So, we're going to introduce a new method called likelihood weighting that generates samples so that we can keep every one. With likelihood weighting, we fix the evidence variables. That is, we say that A will always be positive, and then we sample the rest of the variables, so then we get samples that we want. We would get a list like -b, +a, -b, +a, +b, +a. We get to keep every sample, but we have a problem. The resulting set of samples is inconsistent. We can fix that, however, by assigning a probability to each sample and weighing them correctly.

## Title 63 - Likelihood Weighting 
In likelihood weighting, we're going to be collecting samples just like before, but we're going to add a probabilistic weight to each sample. Now, let's say we want to compute the probability of rain given that the sprinklers are on, and the grass is wet. We start as before. We make a choice for Cloudy, and let's say that, again, we choose Cloudy being positive. Now we want to make a choice for Sprinkler, but we're constrained to always choose Sprinkler being positive, so we'll make that choice. And we know we were dealing with Cloudy being positive, so we're in this row, and we're forced to make the choice of Sprinkler being positive, and that has a probability of only 0.1, so we'll put that 0.1 into the weight. Next, we'll look at the Rain variable, and here we're not constrained in any way, so we make a choice according to the probability tables with Cloudy being positive. And let's say that we choose the more popular choice, and Rain gets the positive value. Now, we look at Wet Grass. We're constrained to choose positive, and we know that the parents are also positive, so we're dealing with this row here. Since it's a constrained choice, we're going to add in or multiply in an additional weight, and I want you to tell me what that weight should be.

## Title 64 - Likelihood Weighting Solution 
The answer is we're looking for the probability of having a +w given a +s and a +r, so that's in this row, so it's 0.99. So, we take our old weight and multiply it by 0.99, gives us a final weight of 0.099 for a sample of +c, +s, +r and +w.

## Title 65 - Likelihood Weighting 1 
When we include the weights, counting this sample that was forced to have a +s and a +w with a weight of 0.099, instead of counting it as a full one sample, we find that likelihood weighting is also consistent.

## Title 66 - Likelihood Weighting 2 
Likelihood weighting is a great technique, but it doesn't solve all our problems. Suppose we wanted to compute the probability of C given +s and +r. In other words, we're constraining Sprinkler and Rain to always be positive. Since we use the evidence when we generate a node that has that evidence as parents, the Wet Grass node will always get good values based on that evidence. But the Cloudy node won't, and so it will be generating values at random without looking at these values, and most of the time, or some of the time, it will be generating values that don't go well with the evidence. Now, we won't have to reject them like we do in rejection sampling, but they'll have a low probability associated with them.

## Title 67 - Gibbs Sampling 
A technique called Gibbs sampling, named after the physicist Josiah Gibbs, takes all the evidence into account and not just the upstream evidence. It uses a method called Markov Chain Monte Carlo, or MCMC. The idea is that we resample just one variable at a time conditioned on all the others. That is, we have a set of variables, and we initialize them to random variables, keeping the evidence values fixed. Maybe we have values like this, and that constitutes one sample, and now, at each iteration through the loop, we select just one non-evidence variable and resample it based on all the other variables. And that will give us another sample, and repeat that again. Choose another variable. Resample that variable and repeat. We end up walking around in this space of assignments of variables randomly. Now, in rejection and likelihood sampling, each sample was independent of the other samples. In MCMC, that's not true. The samples are dependent on each other, and in fact, adjacent samples are very similar. They only vary or differ in one place. However, the technique is still consistent. We won't show the proof for that.

## Title 68 - Monty Hall Problem 
Now, just one more thing. I can't help but describe what is probably the most famous probability problem of all. It's called the Monty Hall Problem after the game show host. And the idea is that you're on a game show, and there's 3 doors: door #1, door #2, and door #3. And behind each door is a prize, and you know that one of the doors contains an expensive sports car, which you would find desirable, and the other 2 doors contain a goat, which you would find less desirable. Now, say you're given a choice, and let's say you choose door #1. But according to the conventions of the game, the host, Monty Hall, will now open one of the doors, knowing that the door that he opens contains a goat, and he shows you door #3. And he now gives you the opportunity to stick with your choice or to switch to the other door. What I want you to tell me is, what is your probability of winning if you stick to door #1, and what is the probability of winning if you switched to door #2?

## Title 69 - Monty Hall Problem Solution 
The answer is that you have a 1/3 chance of winning if you stick with door #1 and a 2/3 chance if you switch to door #2. How do we explain that, and why isn't it 50/50? Well, it's true that there's 2 possibilities, but we've learned from probability that just because there are 2 options doesn't mean that both options are equally likely. It's easier to explain why the first door has a 1/3 probability because when you started, the car could be in any one of 3 places. You chose one of them. That probability was 1/3. And that probability hasn't been changed by the revealing of one of the other doors. Why is door #2 two-thirds? Well, one way to explain it is that the probability has to sum to 1, and if 1/3 is here, the 2/3 has to be here. But why doesn't the same argument that you use for 1 hold for 2? Why can't we say the probability of 2 holding the car was 1/3 before this door was revealed? Why has that changed 2 and has not changed 1? And the reason is because we've learned something about door #2. We've learned that it wasn't the door that was flipped over by the host, and so that additional information has updated the probability, whereas we haven't learned anything additional about door #1 because it was never an option that the host might switch door #1. And in fact, in this case, if we reveal the door, we find that's where the car actually is. So you see, learning probability may end up winning you something.

## Title 70 - Monty Hall Letter 
Now, as a final epilogue, I have here a copy of a letter written by Monty Hall himself in 1990 to Professor Lawrence Denenberg of Harvard who, with Harry Lewis, wrote a statistics book in which they used the Monty Hall Problem as an example, and they wrote to Monty asking him for permission to use his name. Monty kindly granted the permission, but in his letter, he writes, "As I see it, it wouldn't make any difference after the player has selected Door A, and having been shown Door C-- why should he then attempt to switch to Door B? So, we see Monty Hall himself did not understand the Monty Hall Problem. 
